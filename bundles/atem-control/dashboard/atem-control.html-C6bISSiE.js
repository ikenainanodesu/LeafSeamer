import{r as l,j as e,c as R}from"../shared/client-tV2cqGBD.js";const C=({switchers:a,onRemove:p})=>{const[n,c]=l.useState(""),[r,u]=l.useState(null);l.useEffect(()=>{!n&&a.length>0&&c(a[0].ip)},[a]),l.useEffect(()=>{if(!n){u(null);return}const t=nodecg.Replicant(`atem:state:${n}`),o=s=>{u(s)};return nodecg.readReplicant(`atem:state:${n}`,s=>{s&&u(s)}),t.on("change",o),()=>{t.removeListener("change",o)}},[n]);const i=()=>{n&&nodecg.sendMessage("atem:cut",{ip:n})},d=()=>{n&&nodecg.sendMessage("atem:auto",{ip:n})},g=(t,o)=>{n&&nodecg.sendMessage("atem:setSource",{ip:n,type:t,source:o})},m=t=>{n&&nodecg.sendMessage("atem:setTransitionRate",{ip:n,rate:t})},f=(t,o)=>{n&&nodecg.sendMessage("atem:setAuxSource",{ip:n,auxId:t,source:o})},v=t=>{n&&nodecg.sendMessage("atem:runMacro",{ip:n,macroIndex:t})},w=(t,o)=>{t.dataTransfer.setData("sourceId",o.toString())},j=(t,o)=>{const s=parseInt(t.dataTransfer.getData("sourceId"));isNaN(s)||g(o,s)},h=(t,o=!1)=>{const s=["dir"],I=["webcam out","output","mvw","recording status","streaming status","audio status","pgm","pvw"];return Object.entries(t).filter(([M,S])=>{const y=S.toLowerCase();return s.some(x=>y.includes(x))?!1:o?!0:!I.some(x=>y.includes(x))})},b=t=>{t.preventDefault()};return a.length?e.jsxs("div",{style:{padding:"20px",background:"#222",marginBottom:"20px",borderRadius:"8px",border:"1px solid #444"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"white"},children:"Select Switcher: "}),e.jsx("select",{value:n,onChange:t=>c(t.target.value),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:a.map(t=>e.jsxs("option",{value:t.ip,children:[t.alias||t.ip," ",t.connected?"(Connected)":"(Offline)"]},t.ip))})]}),p&&e.jsx("button",{onClick:p,style:{background:"#d32f2f",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:"Remove Page"})]}),r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:20,marginBottom:30},children:[e.jsxs("div",{style:{flex:1,background:"#0a0",padding:20,borderRadius:8,height:100,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"white"},onDrop:t=>j(t,"preview"),onDragOver:b,children:[e.jsx("h3",{children:"PREVIEW"}),e.jsx("div",{style:{fontSize:24,fontWeight:"bold"},children:r.sources[r.previewInput]||`Input ${r.previewInput}`})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,justifyContent:"center"},children:[e.jsx("button",{onClick:i,style:{padding:"15px 30px",background:"#333",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:"CUT"}),e.jsx("button",{onClick:d,style:{padding:"15px 30px",background:"#333",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:"AUTO"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#444",padding:10,borderRadius:4,color:"white"},children:[e.jsx("div",{style:{fontSize:12,marginBottom:5},children:"Duration (frames)"}),e.jsx("input",{type:"range",min:"1",max:"125",value:r.transitionRate||25,onChange:t=>m(parseInt(t.target.value)),style:{width:"100%"}}),e.jsx("input",{type:"number",min:"1",max:"250",value:r.transitionRate||25,onChange:t=>m(parseInt(t.target.value)),style:{width:50,marginTop:5,background:"#222",color:"white",border:"1px solid #555",textAlign:"center"}})]}),r.inTransition&&e.jsx("div",{style:{color:"white"},children:"Transitioning..."})]}),e.jsxs("div",{style:{flex:1,background:"#a00",padding:20,borderRadius:8,height:100,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"white"},onDrop:t=>j(t,"program"),onDragOver:b,children:[e.jsx("h3",{children:"PROGRAM"}),e.jsx("div",{style:{fontSize:24,fontWeight:"bold"},children:r.sources[r.programInput]||`Input ${r.programInput}`})]})]}),e.jsxs("div",{style:{marginBottom:20,color:"white"},children:[e.jsx("h3",{children:"Outputs"}),e.jsxs("div",{style:{display:"flex",gap:20},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:5},children:"Output"}),e.jsxs("select",{value:r.aux?r.aux[0]:0,onChange:t=>f(0,parseInt(t.target.value)),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:[e.jsx("option",{value:0,children:"Select Source..."}),h(r.sources,!0).map(([t,o])=>e.jsx("option",{value:t,children:o},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:5},children:"Webcam Out"}),e.jsxs("select",{value:r.aux?r.aux[1]:0,onChange:t=>f(1,parseInt(t.target.value)),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:[e.jsx("option",{value:0,children:"Select Source..."}),h(r.sources,!0).map(([t,o])=>e.jsx("option",{value:t,children:o},t))]})]})]})]}),e.jsxs("div",{style:{marginBottom:20,color:"white"},children:[e.jsx("h3",{children:"Sources (Drag to PGM/PVW)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:h(r.sources,!1).map(([t,o])=>e.jsx("div",{draggable:!0,onDragStart:s=>w(s,parseInt(t)),onClick:()=>g("preview",parseInt(t)),style:{padding:"10px 20px",background:"#444",borderRadius:4,cursor:"grab",userSelect:"none"},children:o},t))})]}),e.jsxs("div",{style:{color:"white"},children:[e.jsx("h3",{children:"Macros"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:[Object.entries(r.macros).map(([t,o])=>e.jsx("button",{onClick:()=>v(parseInt(t)),style:{padding:"10px 20px",background:"#0056b3",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:o},t)),Object.keys(r.macros).length===0&&e.jsx("div",{children:"No macros found"})]})]})]}):e.jsx("div",{style:{color:"white"},children:"Connecting to switcher state..."})]}):e.jsx("div",{children:"No switchers available."})},k=()=>{const[a,p]=l.useState([]),[n,c]=l.useState([Date.now()]);l.useEffect(()=>{nodecg.Replicant("atem:switchers").on("change",d=>{d&&p(d)})},[]);const r=()=>{c(i=>[...i,Date.now()])},u=i=>{c(d=>d.filter(g=>g!==i))};return a.length===0?e.jsx("div",{style:{color:"white",padding:20},children:"No Active Connections. Please add a switcher in Connection panel."}):e.jsxs("div",{style:{padding:"20px",color:"white",fontFamily:"sans-serif"},children:[e.jsx("div",{style:{marginBottom:20},children:e.jsx("button",{onClick:r,style:{padding:"10px 20px",background:"#2e7d32",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold",fontSize:"14px"},children:"+ Add Page"})}),n.map(i=>e.jsx(C,{switchers:a,onRemove:n.length>1?()=>u(i):void 0},i))]})},D=R.createRoot(document.getElementById("root"));D.render(e.jsx(k,{}));
