import{c as I,j as t,r as i}from"../shared/client-tV2cqGBD.js";const R=()=>{const[c,x]=i.useState([]),[s,l]=i.useState(""),[r,m]=i.useState(null);i.useEffect(()=>{nodecg.Replicant("atem:switchers").on("change",n=>{n&&(x(n),!s&&n.length>0&&l(n[0].ip))})},[s]),i.useEffect(()=>{if(!s)return;const e=nodecg.Replicant(`atem:state:${s}`),n=o=>{m(o)};return e.on("change",n),()=>{e.removeListener("change",n)}},[s]);const j=()=>{s&&nodecg.sendMessage("atem:cut",{ip:s})},f=()=>{s&&nodecg.sendMessage("atem:auto",{ip:s})},d=(e,n)=>{s&&nodecg.sendMessage("atem:setSource",{ip:s,type:e,source:n})},u=e=>{s&&nodecg.sendMessage("atem:setTransitionRate",{ip:s,rate:e})},p=(e,n)=>{s&&nodecg.sendMessage("atem:setAuxSource",{ip:s,auxId:e,source:n})},v=e=>{s&&nodecg.sendMessage("atem:runMacro",{ip:s,macroIndex:e})},b=(e,n)=>{e.dataTransfer.setData("sourceId",n.toString())},g=(e,n)=>{const o=parseInt(e.dataTransfer.getData("sourceId"));isNaN(o)||d(n,o)},a=e=>{const n=["webcam out","output","mvw","recording status","streaming status","audio status","pgm","pvw","dir"];return Object.entries(e).filter(([o,y])=>{const w=y.toLowerCase();return!n.some(S=>w.includes(S))})},h=e=>{e.preventDefault()};return c.length===0?t.jsx("div",{style:{color:"white",padding:20},children:"No Active Connections. Please add a switcher in Connection panel."}):t.jsxs("div",{style:{padding:"20px",color:"white",fontFamily:"sans-serif"},children:[t.jsxs("div",{style:{marginBottom:20},children:[t.jsx("label",{children:"Select Switcher: "}),t.jsx("select",{value:s,onChange:e=>l(e.target.value),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:c.map(e=>t.jsxs("option",{value:e.ip,children:[e.alias||e.ip," ",e.connected?"(Connected)":"(Offline)"]},e.ip))})]}),r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",gap:20,marginBottom:30},children:[t.jsxs("div",{style:{flex:1,background:"#0a0",padding:20,borderRadius:8,height:100,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},onDrop:e=>g(e,"preview"),onDragOver:h,children:[t.jsx("h3",{children:"PREVIEW"}),t.jsx("div",{style:{fontSize:24,fontWeight:"bold"},children:r.sources[r.previewInput]||`Input ${r.previewInput}`})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,justifyContent:"center"},children:[t.jsx("button",{onClick:j,style:{padding:"15px 30px",background:"#333",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:"CUT"}),t.jsx("button",{onClick:f,style:{padding:"15px 30px",background:"#333",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:"AUTO"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#444",padding:10,borderRadius:4},children:[t.jsx("div",{style:{fontSize:12,marginBottom:5},children:"Duration (frames)"}),t.jsx("input",{type:"range",min:"1",max:"125",value:r.transitionRate||25,onChange:e=>u(parseInt(e.target.value)),style:{width:"100%"}}),t.jsx("input",{type:"number",min:"1",max:"250",value:r.transitionRate||25,onChange:e=>u(parseInt(e.target.value)),style:{width:50,marginTop:5,background:"#222",color:"white",border:"1px solid #555",textAlign:"center"}})]}),r.inTransition&&t.jsx("div",{children:"Transitioning..."})]}),t.jsxs("div",{style:{flex:1,background:"#a00",padding:20,borderRadius:8,height:100,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},onDrop:e=>g(e,"program"),onDragOver:h,children:[t.jsx("h3",{children:"PROGRAM"}),t.jsx("div",{style:{fontSize:24,fontWeight:"bold"},children:r.sources[r.programInput]||`Input ${r.programInput}`})]})]}),t.jsxs("div",{style:{marginBottom:20},children:[t.jsx("h3",{children:"Outputs"}),t.jsxs("div",{style:{display:"flex",gap:20},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:5},children:"Output"}),t.jsxs("select",{value:r.aux?r.aux[0]:0,onChange:e=>p(0,parseInt(e.target.value)),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:[t.jsx("option",{value:0,children:"Select Source..."}),a(r.sources).map(([e,n])=>t.jsx("option",{value:e,children:n},e))]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:5},children:"Webcam Out"}),t.jsxs("select",{value:r.aux?r.aux[1]:0,onChange:e=>p(1,parseInt(e.target.value)),style:{padding:5,background:"#333",color:"white",border:"1px solid #555"},children:[t.jsx("option",{value:0,children:"Select Source..."}),a(r.sources).map(([e,n])=>t.jsx("option",{value:e,children:n},e))]})]})]})]}),t.jsxs("div",{style:{marginBottom:20},children:[t.jsx("h3",{children:"Sources (Drag to PGM/PVW)"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:a(r.sources).map(([e,n])=>t.jsx("div",{draggable:!0,onDragStart:o=>b(o,parseInt(e)),onClick:()=>d("preview",parseInt(e)),style:{padding:"10px 20px",background:"#444",borderRadius:4,cursor:"grab",userSelect:"none"},children:n},e))})]}),t.jsxs("div",{children:[t.jsx("h3",{children:"Macros"}),t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:[Object.entries(r.macros).map(([e,n])=>t.jsx("button",{onClick:()=>v(parseInt(e)),style:{padding:"10px 20px",background:"#0056b3",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:n},e)),Object.keys(r.macros).length===0&&t.jsx("div",{children:"No macros found"})]})]})]}):t.jsx("div",{children:"Connecting to switcher state..."})]})},C=I.createRoot(document.getElementById("root"));C.render(t.jsx(R,{}));
